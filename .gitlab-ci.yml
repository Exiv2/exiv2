.build_template: &distro_build
  script:
    - python3 ci/test_build.py

Fedora:
  image: fedora:28
  before_script:
    - dnf -y --refresh install gcc-c++ clang cmake make expat-devel zlib-devel libssh-devel libcurl-devel gtest-devel which
  <<: *distro_build

Debian:
  image: debian:9
  before_script:
    - apt-get update
    - apt-get install -y cmake g++ clang make python3 libexpat1-dev zlib1g-dev libssh-dev libcurl4-openssl-dev libgtest-dev
  <<: *distro_build

Archlinux:
  image: base/archlinux
  before_script:
    - pacman --noconfirm -Sy
    - pacman --noconfirm -S gcc clang cmake make expat zlib libssh curl gtest python
  script:
    - python ci/test_build.py

Ubuntu:
  image: ubuntu:18.04
  before_script:
    - apt-get update
    - apt-get install -y cmake g++ clang make python3 libexpat1-dev zlib1g-dev libssh-dev libcurl4-openssl-dev libgtest-dev google-mock
  <<: *distro_build

CentOS:
  image: centos:7
  before_script:
    - yum -y install yum-plugin-copr
    # enable copr for gtest
    - yum -y copr enable defolos/devel
    - yum clean all
    - yum -y install gcc-c++ clang cmake make expat-devel zlib-devel libssh-devel libcurl-devel gtest-devel which
  <<: *distro_build
